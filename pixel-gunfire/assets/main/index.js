System.register("chunks:///_virtual/ActorManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EntityManager.ts","./index.ts","./index3.ts","./DataManager.ts","./EventManager.ts","./index2.ts","./WeaponManager.ts","./ActorStateMachine.ts","./Enum.ts"],(function(t){var n,e,i,a,o,s,r,c,h,d,p,u,l,m,f,g,y;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,a=t.Sprite,o=t.Color,s=t.Label,r=t.instantiate,c=t.ProgressBar},function(t){h=t.EntityManager},null,function(t){d=t.EntityStateEnum,p=t.EventEnum},function(t){u=t.default},function(t){l=t.default},function(t){m=t.radianToAngle},function(t){f=t.WeaponManager},function(t){g=t.ActorStateMachine},function(t){y=t.InputTypeEnum}],execute:function(){var v;e._RF.push({},"4f26aFq6mVDaakt9zWr0m0V","ActorManager",void 0);var M=i.ccclass;i.property,t("ActorManager",M("ActorManager")(v=function(t){function e(){for(var n,e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return(n=t.call.apply(t,[this].concat(i))||this).id=void 0,n._wm=void 0,n._hp=void 0,n._nickname=void 0,n}n(e,t);var i=e.prototype;return i.init=function(t){this.id=t.id,this._hp=this.node.getChildByName("HP"),u.Instance.isMe(this.id)?this._hp.getComponentInChildren(a).color=new o(0,220,0,255):this._hp.getComponentInChildren(a).color=new o(255,0,0,255),this._nickname=this.node.getChildByName("Nickname"),this._nickname.getComponent(s).string=t.nickname,this.fsm=this.addComponent(g),this.fsm.init(t.type),this.state=d.Idle;var n=u.Instance.prefabMap.get(t.weaponType),e=r(n);e.setParent(this.node),e.setPosition(0,38),this._wm=e.addComponent(f),this._wm.init(t)},i.render=function(t){var n=t.position,e=t.direction;this.node.setPosition(n.x,n.y);var i=e.x<0;this.node.setScale(i?-1:1,1);var a=m(Math.atan2(e.y,i?-e.x:e.x));this._wm.node.setRotationFromEuler(0,0,a),this._hp.setScale(i?-1:1,1),this._hp.getComponent(c).progress=t.hp/100,this._nickname.setScale(i?-1:1,1)},i.tick=function(t){if(u.Instance.isMe(this.id))if(u.Instance.jm.input.length()>0){var n=u.Instance.jm.input,e=n.x,i=n.y;l.Instance.emit(p.ClientSync,{type:y.ActorMove,id:this.id,direction:{x:e,y:i},dt:t}),this.state=d.Run}else this.state=d.Idle},e}(h))||v);e._RF.pop()}}}));

System.register("chunks:///_virtual/ActorStateMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./State.ts","./StateMachine.ts","./index3.ts"],(function(t){var e,i,n,a,s,c,r,h,o,u;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,a=t.Animation,s=t.AnimationClip},function(t){c=t.default},function(t){r=t.getInitParamsTrigger,h=t.default},function(t){o=t.ParamsNameEnum,u=t.EntityStateEnum}],execute:function(){var p;i._RF.push({},"b86b5/bQDdGTq7z7A9AbdCh","ActorStateMachine",void 0);var l=n.ccclass;t("ActorStateMachine",l("ActorStateMachine")(p=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.init=function(t){this.type=t,this.animationComponent=this.node.addComponent(a),this.initParams(),this.initStateMachines(),this.initAnimationEvent()},n.initParams=function(){this.params.set(o.Idle,r()),this.params.set(o.Run,r())},n.initStateMachines=function(){this.stateMachines.set(o.Idle,new c(this,""+this.type+u.Idle,s.WrapMode.Loop)),this.stateMachines.set(o.Run,new c(this,""+this.type+u.Run,s.WrapMode.Loop))},n.initAnimationEvent=function(){},n.run=function(){switch(this.currentState){case this.stateMachines.get(o.Idle):case this.stateMachines.get(o.Run):this.params.get(o.Run).value?this.currentState=this.stateMachines.get(o.Run):this.params.get(o.Idle).value?this.currentState=this.stateMachines.get(o.Idle):this.currentState=this.currentState;break;default:this.currentState=this.stateMachines.get(o.Idle)}},i}(h))||p);i._RF.pop()}}}));

System.register("chunks:///_virtual/Api.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"8189epUp+xA7ZJOPuTM/5FS","Api",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/BattleManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.ts","./ActorManager.ts","./BulletManager.ts","./index3.ts","./DataManager.ts","./EventManager.ts","./NetworkManager.ts","./ObjectPoolManager.ts","./ResourceManager.ts","./JoyStickManager.ts","./Enum.ts"],(function(e){var t,n,a,r,s,i,c,o,u,l,f,p,d,h,v,g,_,y,M,m,I,S,x,k;return{setters:[function(e){t=e.inheritsLoose,n=e.createForOfIteratorHelperLoose,a=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,i=e._decorator,c=e.instantiate,o=e.Vec3,u=e.Component,l=e.SpriteFrame,f=e.Prefab},null,function(e){p=e.ActorManager},function(e){d=e.BulletManager},function(e){h=e.EventEnum,v=e.TexturePathEnum,g=e.PrefabPathEnum},function(e){_=e.default},function(e){y=e.default},function(e){M=e.NetworkManager},function(e){m=e.ObjectPoolManager},function(e){I=e.ResourceManager},function(e){S=e.JoyStickManager},function(e){x=e.ApiMsgEnum,k=e.EntityTypeEnum}],execute:function(){var b;s._RF.push({},"e5596Ky85JFt58KDmFaye6Y","BattleManager",void 0);var w=i.ccclass;i.property,e("BattleManager",w("BattleManager")(b=function(e){function s(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._stage=void 0,t._ui=void 0,t._shouldUpdate=!1,t}t(s,e);var i=s.prototype;return i.start=function(){var e=a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._clearGame(),e.next=3,Promise.all([this._loadResources(),this._connectServer()]);case 3:this._initGame();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i._initGame=function(){M.Instance.listen(x.MsgServerSync,this._onServerSync,this),y.Instance.on(h.ClientSync,this._onClientSync,this),_.Instance.jm=this._ui.getComponentInChildren(S),this._initMap(),this._shouldUpdate=!0},i._clearGame=function(){M.Instance.unlisten(x.MsgServerSync,this._onServerSync,this),y.Instance.off(h.ClientSync,this._onClientSync,this),_.Instance.stage=this._stage=this.node.getChildByName("Stage"),this._stage.destroyAllChildren(),this._ui=this.node.getChildByName("UI")},i._loadResources=function(){var e=a(r().mark((function e(){var t,n,a,s,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=r().mark((function e(n){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=I.Instance.loadRes(g[n],f).then((function(e){_.Instance.prefabMap.set(n,e)})),t.push(a);case 2:case"end":return e.stop()}}),e)})),e.t0=r().keys(g);case 3:if((e.t1=e.t0()).done){e.next=8;break}return a=e.t1.value,e.delegateYield(n(a),"t2",6);case 6:e.next=3;break;case 8:s=r().mark((function e(n){var a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=I.Instance.loadDir(v[n],l).then((function(e){_.Instance.textureMap.set(n,e)})),t.push(a);case 2:case"end":return e.stop()}}),e)})),e.t3=r().keys(v);case 10:if((e.t4=e.t3()).done){e.next=15;break}return i=e.t4.value,e.delegateYield(s(i),"t5",13);case 13:e.next=10;break;case 15:return e.next=17,Promise.all(t);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i._connectServer=function(){var e=a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.Instance.connect();case 3:e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,new Promise((function(e){return setTimeout(e,1e3)}));case 9:return e.next=11,this._connectServer();case 11:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),i._onServerSync=function(e){for(var t,a=n(e.inputs);!(t=a()).done;){var r=t.value;_.Instance.applyInput(r)}},i._onClientSync=function(e){var t={input:e,frameId:_.Instance.frameId++};M.Instance.send(x.MsgClientSync,t)},i.update=function(e){this._shouldUpdate&&(this._render(),this._tick(e))},i._tick=function(e){this._tickActors(e)},i._render=function(){this._renderActors(),this._renderBullets(),this._renderStage()},i._initMap=function(){var e=_.Instance.prefabMap.get(k.Map);c(e).setParent(this._stage)},i._tickActors=function(e){for(var t,a=n(_.Instance.state.actors);!(t=a()).done;){var r=t.value;_.Instance.actorMap.get(r.id).tick(e)}},i._renderActors=function(){for(var e,t=n(_.Instance.state.actors);!(e=t()).done;){var a=e.value,r=_.Instance.actorMap.get(a.id);if(!r){var s=_.Instance.prefabMap.get(a.type),i=c(s);i.setParent(this._stage),r=i.addComponent(p),_.Instance.actorMap.set(a.id,r),r.init(a)}r.render(a)}},i._renderBullets=function(){for(var e,t=n(_.Instance.state.bullets);!(e=t()).done;){var a=e.value,r=_.Instance.bulletMap.get(a.id);if(!r){var s,i=m.Instance.get(a.type);r=null!=(s=i.getComponent(d))?s:i.addComponent(d),_.Instance.bulletMap.set(a.id,r),r.init(a)}r.render(a)}},i._renderStage=function(){var e=_.Instance.state.actors.find((function(e){return _.Instance.isMe(e.id)}));if(e){var t=new o(-e.position.x,-e.position.y);if(_.Instance.jm.input){var n=_.Instance.jm.input;t.x-=160*n.x,t.y-=160*n.y}this._stage.setPosition(o.lerp(new o,this._stage.getPosition(),t,.1))}},s}(u))||b);s._RF.pop()}}}));

System.register("chunks:///_virtual/BulletManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EntityManager.ts","./index.ts","./index3.ts","./DataManager.ts","./EventManager.ts","./ObjectPoolManager.ts","./index2.ts","./ExplosionManager.ts","./BulletStateMachine.ts","./Enum.ts"],(function(n){var t,e,o,i,a,s,r,l,u,c,p,d,f;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,o=n._decorator},function(n){i=n.EntityManager},null,function(n){a=n.EntityStateEnum,s=n.EventEnum},function(n){r=n.default},function(n){l=n.default},function(n){u=n.ObjectPoolManager},function(n){c=n.radianToAngle},function(n){p=n.ExplosionManager},function(n){d=n.BulletStateMachine},function(n){f=n.EntityTypeEnum}],execute:function(){var h;e._RF.push({},"4fe7d0hsnJJnaZ18tXp7j9K","BulletManager",void 0);var E=o.ccclass;o.property,n("BulletManager",E("BulletManager")(h=function(n){function e(){for(var t,e=arguments.length,o=new Array(e),i=0;i<e;i++)o[i]=arguments[i];return(t=n.call.apply(n,[this].concat(o))||this).id=void 0,t}t(e,n);var o=e.prototype;return o.init=function(n){this.id=n.id,this.fsm=this.addComponent(d),this.fsm.init(n.type),this.state=a.Idle,l.Instance.on(s.ExplosionBorn,this._onExplosionBorn,this)},o._onExplosionBorn=function(n,t){var e;if(this.id===n){var o=u.Instance.get(f.Explosion);(null!=(e=o.getComponent(p))?e:o.addComponent(p)).init(f.Explosion,t),r.Instance.bulletMap.delete(this.id),l.Instance.off(s.ExplosionBorn,this._onExplosionBorn,this),u.Instance.ret(this.node)}},o.render=function(n){var t=n.position,e=n.direction;this.node.setPosition(t.x,t.y);var o=c(Math.atan2(e.y,e.x));this.node.setRotationFromEuler(0,0,o)},e}(i))||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/BulletStateMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./State.ts","./StateMachine.ts","./index3.ts"],(function(t){var e,i,n,a,s,c,r,u,o,h;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,a=t.Animation,s=t.AnimationClip},function(t){c=t.default},function(t){r=t.getInitParamsTrigger,u=t.default},function(t){o=t.ParamsNameEnum,h=t.EntityStateEnum}],execute:function(){var l;i._RF.push({},"83013jkd4pA+b+6jE7hSGsJ","BulletStateMachine",void 0);var d=n.ccclass;t("BulletStateMachine",d("BulletStateMachine")(l=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var n=i.prototype;return n.init=function(t){this.type=t,this.animationComponent=this.node.addComponent(a),this.initParams(),this.initStateMachines(),this.initAnimationEvent()},n.initParams=function(){this.params.set(o.Idle,r())},n.initStateMachines=function(){this.stateMachines.set(o.Idle,new c(this,""+this.type+h.Idle,s.WrapMode.Loop))},n.initAnimationEvent=function(){},n.run=function(){switch(this.currentState){case this.stateMachines.get(o.Idle):this.params.get(o.Idle).value?this.currentState=this.stateMachines.get(o.Idle):this.currentState=this.currentState;break;default:this.currentState=this.stateMachines.get(o.Idle)}},i}(u))||l);i._RF.pop()}}}));

System.register("chunks:///_virtual/DataManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts","./index.ts","./index3.ts","./EventManager.ts","./Enum.ts"],(function(t){var i,e,s,n,o,a,r,p;return{setters:[function(t){i=t.inheritsLoose,e=t.createClass},function(t){s=t.cclegacy,n=t.UITransform},function(t){o=t.default},null,function(t){a=t.EventEnum},function(t){r=t.default},function(t){p=t.InputTypeEnum}],execute:function(){s._RF.push({},"1682e0WTk9Gs4rKkrrs0wud","DataManager",void 0);var h=t("default",function(t){function s(){for(var i,e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return(i=t.call.apply(t,[this].concat(s))||this).jm=void 0,i._stage=void 0,i._stageWidth=void 0,i._stageHeight=void 0,i.prefabMap=new Map,i.textureMap=new Map,i.actorMap=new Map,i.bulletMap=new Map,i.state={actors:[],bullets:[],nextBulletId:1},i.playerInfo=null,i.roomInfo=null,i.frameId=1,i}i(s,t);var o=s.prototype;return o.isMe=function(t){return this.playerInfo&&this.playerInfo.id===t},o.applyInput=function(t){switch(t.type){case p.ActorMove:this._applyActorMove(t);break;case p.WeaponShoot:this._applyWeaponShoot(t);break;case p.TimePast:this._applyTimePast(t)}},o._applyActorMove=function(t){var i=this.state.actors.find((function(i){return i.id===t.id}));if(i){var e=t.direction,s=e.x,n=e.y,o=t.dt;i.direction.x=s,i.direction.y=n,i.position.x+=s*o*100,i.position.y+=n*o*100,i.position.x<-this._stageWidth/2?i.position.x=-this._stageWidth/2:i.position.x>this._stageWidth/2&&(i.position.x=this._stageWidth/2),i.position.y<-this._stageHeight/2?i.position.y=-this._stageHeight/2:i.position.y>this._stageHeight/2&&(i.position.y=this._stageHeight/2)}},o._applyWeaponShoot=function(t){var i=this.state.actors.find((function(i){return i.id===t.owner}));if(i){var e=t.position,s=t.direction,n={type:i.bulletType,id:this.state.nextBulletId++,owner:i.id,position:{x:e.x,y:e.y},direction:{x:s.x,y:s.y}};this.state.bullets.push(n)}},o._applyTimePast=function(t){for(var i=t.dt,e=this.state.bullets.length-1;e>=0;e--){for(var s=this.state.bullets[e],n=!1,o=this.state.actors.length-1;o>=0;o--){var p=this.state.actors[o];if(p.id!==s.owner&&Math.pow(s.position.x-p.position.x,2)+Math.pow(s.position.y-p.position.y-40,2)<Math.pow(35,2)){p.hp-=5,this.state.bullets.splice(e,1),r.Instance.emit(a.ExplosionBorn,s.id,s.position),n=!0;break}}n||(s.position.x<-this._stageWidth/2||s.position.x>this._stageWidth/2||s.position.y<-this._stageHeight/2||s.position.y>this._stageHeight/2?(this.state.bullets.splice(e,1),r.Instance.emit(a.ExplosionBorn,s.id,s.position)):(s.position.x+=s.direction.x*i*600,s.position.y+=s.direction.y*i*600))}},e(s,[{key:"stage",get:function(){return this._stage},set:function(t){this._stage=t;var i=this._stage.getComponent(n);this._stageWidth=i.width,this._stageHeight=i.height}}],[{key:"Instance",get:function(){return t.GetInstance.call(this)}}]),s}(o));window.DataManager=h.Instance,s._RF.pop()}}}));

System.register("chunks:///_virtual/EntityManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n,r,a,s;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){r=t.cclegacy,a=t._decorator,s=t.Component}],execute:function(){var i;r._RF.push({},"2e4ee1T0blC75eqjQqNqSf3","EntityManager",void 0);var o=a.ccclass;a.property,t("EntityManager",o("EntityManager")(i=function(t){function r(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).fsm=void 0,e._state=void 0,e}return e(r,t),n(r,[{key:"state",get:function(){return this._state},set:function(t){this._state=t,this.fsm.setParams(t,!0)}}]),r}(s))||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/Enum.ts",["cc"],(function(o){var e;return{setters:[function(o){e=o.cclegacy}],execute:function(){e._RF.push({},"0e672+AIMZICr4TGIcN7hsE","Enum",void 0);o("InputTypeEnum",function(o){return o.ActorMove="ActorMove",o.WeaponShoot="WeaponShoot",o.TimePast="TimePast",o}({})),o("EntityTypeEnum",function(o){return o.Map="Map",o.Actor1="Actor1",o.Actor2="Actor2",o.Weapon1="Weapon1",o.Weapon2="Weapon2",o.Bullet1="Bullet1",o.Bullet2="Bullet2",o.Explosion="Explosion",o}({})),o("ApiMsgEnum",function(o){return o.ApiPlayerJoin="ApiPlayerJoin",o.ApiPlayerList="ApiPlayerList",o.ApiRoomCreate="ApiRoomCreate",o.ApiRoomList="ApiRoomList",o.ApiRoomJoin="ApiRoomJoin",o.ApiRoomLeave="ApiRoomLeave",o.ApiGameStart="ApiGameStart",o.MsgPlayerList="MsgPlayerList",o.MsgRoomList="MsgRoomList",o.MsgRoom="MsgRoom",o.MsgGameStart="MsgGameStart",o.MsgClientSync="MsgClientSync",o.MsgServerSync="MsgServerSync",o}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts"],(function(t){var n,e,a,c;return{setters:[function(t){n=t.inheritsLoose,e=t.createClass},function(t){a=t.cclegacy},function(t){c=t.default}],execute:function(){a._RF.push({},"2aa2efesBRO56U3S8mdv5Fk","EventManager",void 0);t("default",function(t){function a(){for(var n,e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];return(n=t.call.apply(t,[this].concat(a))||this).map=new Map,n}n(a,t);var c=a.prototype;return c.on=function(t,n,e){this.map.has(t)?this.map.get(t).push({cb:n,ctx:e}):this.map.set(t,[{cb:n,ctx:e}])},c.off=function(t,n,e){if(this.map.has(t)){var a=this.map.get(t).findIndex((function(t){return n===t.cb&&t.ctx===e}));a>-1&&this.map.get(t).splice(a,1)}},c.emit=function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),a=1;a<n;a++)e[a-1]=arguments[a];this.map.has(t)&&this.map.get(t).forEach((function(t){var n=t.cb,a=t.ctx;n.apply(a,e)}))},c.clear=function(){this.map.clear()},e(a,null,[{key:"Instance",get:function(){return t.GetInstance.call(this)}}]),a}(c));a._RF.pop()}}}));

System.register("chunks:///_virtual/ExplosionManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EntityManager.ts","./index3.ts","./ExplosionStateMachine.ts"],(function(t){var n,i,o,e,s,a;return{setters:[function(t){n=t.inheritsLoose},function(t){i=t.cclegacy,o=t._decorator},function(t){e=t.EntityManager},function(t){s=t.EntityStateEnum},function(t){a=t.ExplosionStateMachine}],execute:function(){var r;i._RF.push({},"0c5d8alDFlJGJMDIhTk4+jY","ExplosionManager",void 0);var c=o.ccclass;o.property,t("ExplosionManager",c("ExplosionManager")(r=function(t){function i(){return t.apply(this,arguments)||this}return n(i,t),i.prototype.init=function(t,n){this.fsm=this.addComponent(a),this.fsm.init(t),this.node.setPosition(n.x,n.y),this.state=s.Idle},i}(e))||r);i._RF.pop()}}}));

System.register("chunks:///_virtual/ExplosionStateMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./State.ts","./StateMachine.ts","./index3.ts","./ObjectPoolManager.ts"],(function(t){var n,e,i,a,s,o,c,r,h,u,l;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,i=t._decorator,a=t.Animation,s=t.AnimationClip},function(t){o=t.default},function(t){c=t.getInitParamsTrigger,r=t.default},function(t){h=t.ParamsNameEnum,u=t.EntityStateEnum},function(t){l=t.ObjectPoolManager}],execute:function(){var p;e._RF.push({},"2c251EUp7xOAYxfFCUjvPf1","ExplosionStateMachine",void 0);var f=i.ccclass;t("ExplosionStateMachine",f("ExplosionStateMachine")(p=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var i=e.prototype;return i.init=function(t){this.type=t,this.animationComponent=this.node.addComponent(a),this.initParams(),this.initStateMachines(),this.initAnimationEvent()},i.initParams=function(){this.params.set(h.Idle,c())},i.initStateMachines=function(){this.stateMachines.set(h.Idle,new o(this,""+this.type+u.Idle,s.WrapMode.Normal))},i.initAnimationEvent=function(){var t=this;this.animationComponent.on(a.EventType.FINISHED,(function(){l.Instance.ret(t.node)}))},i.run=function(){switch(this.currentState){case this.stateMachines.get(h.Idle):this.params.get(h.Idle).value?this.currentState=this.stateMachines.get(h.Idle):this.currentState=this.currentState;break;default:this.currentState=this.stateMachines.get(h.Idle)}},e}(r))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/HallManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.ts","./index3.ts","./DataManager.ts","./NetworkManager.ts","./PlayerManager.ts","./RoomManager2.ts","./Enum.ts"],(function(e){var r,n,t,o,a,i,s,l,c,u,p,f,h,m,y,g,L,d,b,v,P;return{setters:[function(e){r=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,o=e.assertThisInitialized,a=e.createForOfIteratorHelperLoose,i=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e._decorator,u=e.Label,p=e.Node,f=e.Prefab,h=e.instantiate,m=e.Component,y=e.director},null,function(e){g=e.SceneEnum},function(e){L=e.default},function(e){d=e.NetworkManager},function(e){b=e.PlayerManager},function(e){v=e.RoomManager},function(e){P=e.ApiMsgEnum}],execute:function(){var _,R,C,M,w,I,S,x,k,A,z,E,H;l._RF.push({},"b3a494Lm7tBSrSmwIhoU/Mo","HallManager",void 0);var N=c.ccclass,D=c.property;e("HallManager",(_=N("HallManager"),R=D(u),C=D(p),M=D(f),w=D(p),I=D(f),_((k=r((x=function(e){function r(){for(var r,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=e.call.apply(e,[this].concat(a))||this,t(r,"playerNameLabel",k,o(r)),t(r,"playerContainer",A,o(r)),t(r,"playerPrefab",z,o(r)),t(r,"roomContainer",E,o(r)),t(r,"roomPrefab",H,o(r)),r}n(r,e);var l=r.prototype;return l.onLoad=function(){this.playerNameLabel.string=L.Instance.playerInfo.nickname},l.start=function(){d.Instance.listen(P.MsgPlayerList,this._onPlayerListSync,this),d.Instance.listen(P.MsgRoomList,this._onRoomListSync,this),this._getPlayerList(),this._getRoomList()},l.onDestroy=function(){d.Instance.unlisten(P.MsgPlayerList,this._onPlayerListSync,this),d.Instance.unlisten(P.MsgRoomList,this._onRoomListSync,this)},l._getPlayerList=function(){var e=i(s().mark((function e(){var r,n,t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Instance.callApi(P.ApiPlayerList,{});case 2:r=e.sent,n=r.success,t=r.res,o=r.error,n?this._renderPlayerList(t.list):console.error("Error fetching player list:",o);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l._onPlayerListSync=function(e){this._renderPlayerList(e.list)},l._renderPlayerList=function(e){for(var r,n=a(this.playerContainer.children);!(r=n()).done;){r.value.active=!1}for(;this.playerContainer.children.length<e.length;){var t=h(this.playerPrefab);t.active=!1,t.setParent(this.playerContainer)}for(var o=0;o<e.length;o++)this.playerContainer.children[o].getComponent(b).init(e[o])},l._getRoomList=function(){var e=i(s().mark((function e(){var r,n,t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Instance.callApi(P.ApiRoomList,{});case 2:r=e.sent,n=r.success,t=r.res,o=r.error,n?this._renderRoomList(t.list):console.error("Error fetching room list:",o);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l._onRoomListSync=function(e){this._renderRoomList(e.list)},l._renderRoomList=function(e){for(var r,n=a(this.roomContainer.children);!(r=n()).done;){r.value.active=!1}for(;this.roomContainer.children.length<e.length;){var t=h(this.roomPrefab);t.active=!1,t.setParent(this.roomContainer)}for(var o=0;o<e.length;o++)this.roomContainer.children[o].getComponent(v).init(e[o])},l.handleClickCreateRoom=function(){var e=i(s().mark((function e(){var r,n,t,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.Instance.callApi(P.ApiRoomCreate,{name:""});case 2:r=e.sent,n=r.success,t=r.res,o=r.error,n?(L.Instance.roomInfo=t.room,y.loadScene(g.Room)):console.error("Error creating room:",o);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r}(m)).prototype,"playerNameLabel",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=r(x.prototype,"playerContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=r(x.prototype,"playerPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=r(x.prototype,"roomContainer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=r(x.prototype,"roomPrefab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=x))||S));l._RF.pop()}}}));

System.register("chunks:///_virtual/index.ts",["cc","./Api.ts","./Enum.ts","./Model.ts","./Msg.ts","./State2.ts"],(function(n){var t;return{setters:[function(n){t=n.cclegacy},null,function(t){var u={};u.ApiMsgEnum=t.ApiMsgEnum,u.EntityTypeEnum=t.EntityTypeEnum,u.InputTypeEnum=t.InputTypeEnum,n(u)},null,null,null],execute:function(){t._RF.push({},"2a7bd9LuFtD7radf4AdA8qD","index",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/index2.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"2e2808uUqNGWqz1+0Eu9R1r","index",void 0);var r=/\((\d+)\)/,e=function(n){var t;return parseInt((null==(t=n.match(r))?void 0:t[1])||"0")};n("sortSpriteFrame",(function(n){return n.sort((function(n,t){return e(n.name)-e(t.name)}))})),n("radianToAngle",(function(n){return 180*n/Math.PI}));t._RF.pop()}}}));

System.register("chunks:///_virtual/index3.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"39328bCewlE0ZVfBJ5+Wzbq","index",void 0);e("FsmParamTypeEnum",function(e){return e.Number="Number",e.Trigger="Trigger",e}({})),e("ParamsNameEnum",function(e){return e.Idle="Idle",e.Run="Run",e.Attack="Attack",e}({})),e("EventEnum",function(e){return e.WeaponShoot="WeaponShoot",e.ExplosionBorn="ExplosionBorn",e.BulletBorn="BulletBorn",e.ClientSync="ClientSync",e}({})),e("PrefabPathEnum",function(e){return e.Map="prefab/Map",e.Actor1="prefab/Actor",e.Actor2="prefab/Actor",e.Weapon1="prefab/Weapon1",e.Weapon2="prefab/Weapon2",e.Bullet1="prefab/Bullet1",e.Bullet2="prefab/Bullet2",e.Explosion="prefab/Explosion",e}({})),e("TexturePathEnum",function(e){return e.Actor1Idle="texture/actor/actor1/idle",e.Actor1Run="texture/actor/actor1/run",e.Actor2Idle="texture/actor/actor2/idle",e.Actor2Run="texture/actor/actor2/run",e.Weapon1Idle="texture/weapon/weapon1/idle",e.Weapon1Attack="texture/weapon/weapon1/attack",e.Weapon2Idle="texture/weapon/weapon2/idle",e.Weapon2Attack="texture/weapon/weapon2/attack",e.Bullet1Idle="texture/bullet/bullet1",e.Bullet2Idle="texture/bullet/bullet2",e.ExplosionIdle="texture/explosion",e}({})),e("EntityStateEnum",function(e){return e.Idle="Idle",e.Run="Run",e.Attack="Attack",e}({})),e("SceneEnum",function(e){return e.Login="Login",e.Hall="Hall",e.Room="Room",e.Battle="Battle",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/JoyStickManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,i,n,s,e,h,c,u;return{setters:[function(t){o=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,s=t.Vec2,e=t.UITransform,h=t.input,c=t.Input,u=t.Component}],execute:function(){var a;i._RF.push({},"5540adwjwVLuaIywesiuKaj","JoyStickManager",void 0);var _=n.ccclass;n.property,t("JoyStickManager",_("JoyStickManager")(a=function(t){function i(){for(var o,i=arguments.length,n=new Array(i),e=0;e<i;e++)n[e]=arguments[e];return(o=t.call.apply(t,[this].concat(n))||this).input=new s(0,0),o._body=void 0,o._stick=void 0,o._defaultPos=void 0,o._radius=void 0,o._touchId=null,o}o(i,t);var n=i.prototype;return n.onLoad=function(){this._body=this.node.getChildByName("Body"),this._body.active=!1,this._stick=this._body.getChildByName("Stick"),this._defaultPos=new s(this._body.position.x,this._body.position.y),this._radius=this._body.getComponent(e).width/2,h.on(c.EventType.TOUCH_START,this._onTouchStart,this),h.on(c.EventType.TOUCH_MOVE,this._onTouchMove,this),h.on(c.EventType.TOUCH_END,this._onTouchEnd,this)},n.onDestroy=function(){h.off(c.EventType.TOUCH_START,this._onTouchStart,this),h.off(c.EventType.TOUCH_MOVE,this._onTouchMove,this),h.off(c.EventType.TOUCH_END,this._onTouchEnd,this)},n._onTouchStart=function(t){if(null===this._touchId){var o=t.getUILocation();o.x>this.node.parent.getComponent(e).width/2||(this._touchId=t.getID(),this._body.active=!0,this._body.setPosition(o.x,o.y))}},n._onTouchMove=function(t){if(null!==this._touchId&&t.getID()===this._touchId){var o=t.getUILocation(),i=new s(o.x-this._body.position.x,o.y-this._body.position.y);i.length()>this._radius&&i.normalize().multiplyScalar(this._radius),this._stick.setPosition(i.x,i.y),this.input=i.normalize()}},n._onTouchEnd=function(t){null!==this._touchId&&t.getID()===this._touchId&&(this._touchId=null,this._body.active=!1,this._body.setPosition(this._defaultPos.x,this._defaultPos.y),this._stick.setPosition(0,0),this.input=new s(0,0))},i}(u))||a);i._RF.pop()}}}));

System.register("chunks:///_virtual/LoginManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.ts","./index3.ts","./DataManager.ts","./NetworkManager.ts","./Enum.ts"],(function(e){var n,r,t,a,o,s,i,c,u,l,g,p,d;return{setters:[function(e){n=e.inheritsLoose,r=e.asyncToGenerator,t=e.regeneratorRuntime},function(e){a=e.cclegacy,o=e._decorator,s=e.EditBox,i=e.Label,c=e.director,u=e.Component},null,function(e){l=e.SceneEnum},function(e){g=e.default},function(e){p=e.NetworkManager},function(e){d=e.ApiMsgEnum}],execute:function(){var f;a._RF.push({},"819c0Ci2q9CSam7ExYG3erT","LoginManager",void 0);var h=o.ccclass;o.property,e("LoginManager",h("LoginManager")(f=function(e){function a(){for(var n,r=arguments.length,t=new Array(r),a=0;a<r;a++)t[a]=arguments[a];return(n=e.call.apply(e,[this].concat(t))||this)._input=void 0,n._errorMessage=void 0,n}n(a,e);var o=a.prototype;return o.onLoad=function(){this._input=this.node.getChildByName("Input").getComponent(s),this._errorMessage=this.node.getChildByName("ErrorMessage").getComponent(i),this._errorMessage.string="",c.preloadScene(l.Hall),c.preloadScene(l.Room),c.preloadScene(l.Battle),p.Instance.connect()},o.handleClickLogin=function(){var e=r(t().mark((function e(){var n,r,a,o,s;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._input.string){e.next=4;break}return this._errorMessage.string="昵称不能为空",e.abrupt("return");case 4:if(p.Instance.isConnected){e.next=7;break}return p.Instance.connect(),e.abrupt("return");case 7:return e.next=9,p.Instance.callApi(d.ApiPlayerJoin,{nickname:n});case 9:r=e.sent,a=r.success,o=r.res,s=r.error,a?(this._errorMessage.string="",g.Instance.playerInfo=o.player,c.loadScene(l.Hall)):this._errorMessage.string=s;case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a}(u))||f);a._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./EntityManager.ts","./Singleton.ts","./State.ts","./StateMachine.ts","./StateMachineTemplate.ts","./SubStateMachine.ts","./Api.ts","./Enum.ts","./Model.ts","./Msg.ts","./State2.ts","./index.ts","./ActorManager.ts","./ActorStateMachine.ts","./BulletManager.ts","./BulletStateMachine.ts","./ExplosionManager.ts","./ExplosionStateMachine.ts","./WeaponManager.ts","./WeaponStateMachine.ts","./index3.ts","./DataManager.ts","./EventManager.ts","./NetworkManager.ts","./ObjectPoolManager.ts","./ResourceManager.ts","./BattleManager.ts","./HallManager.ts","./LoginManager.ts","./RoomManager.ts","./JoyStickManager.ts","./PlayerManager.ts","./RoomManager2.ts","./ShootManager.ts","./index2.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Model.ts",["cc","./Enum.ts"],(function(){var e;return{setters:[function(t){e=t.cclegacy},null],execute:function(){e._RF.push({},"b5f09QpOj1M/4xPAi4/GI/Z","Model",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/Msg.ts",["cc"],(function(){var t;return{setters:[function(c){t=c.cclegacy}],execute:function(){t._RF.push({},"6e055IE/mxGaoa0jc0E1qNt","Msg",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/NetworkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts"],(function(n){var t,e,o,c;return{setters:[function(n){t=n.inheritsLoose,e=n.createClass},function(n){o=n.cclegacy},function(n){c=n.default}],execute:function(){o._RF.push({},"93352yVnotNtIjFPAXZHpn0","NetworkManager",void 0);n("NetworkManager",function(n){function o(){for(var t,e=arguments.length,o=new Array(e),c=0;c<e;c++)o[c]=arguments[c];return(t=n.call.apply(n,[this].concat(o))||this)._ws=void 0,t._map=new Map,t._connecting=null,t}t(o,n);var c=o.prototype;return c.connect=function(){var n=this;return this.isConnected?Promise.resolve():(null===this._connecting&&(this._connecting=new Promise((function(t,e){n._ws=new WebSocket("ws://122.51.127.27:9876"),n._ws.onopen=function(){n._connecting=null,t(),console.log("WebSocket connection opened")},n._ws.onerror=function(t){n._connecting=null,n._ws=null,e(t)},n._ws.onmessage=function(t){var e=JSON.parse(t.data),o=e.name,c=e.data;n._map.has(o)&&n._map.get(o).forEach((function(n){var t=n.cb,e=n.ctx;t.call(e,c)}))},n._ws.onclose=function(t){n._connecting=null,n._ws=null,console.log("WebSocket connection closed",t.code,t.reason)}}))),this._connecting)},c.callApi=function(n,t){var e=this;return new Promise((function(o,c){var i=function t(c){clearTimeout(s),e.unlisten(n,t,null),o(c)};e.listen(n,i,null);var s=setTimeout((function(){e.unlisten(n,i,null),c(new Error("API call timed out for "+n))}),5e3);e.send(n,t)}))},c.send=function(n,t){var e=JSON.stringify({name:n,data:t});this._ws.send(e)},c.listen=function(n,t,e){this._map.has(n)?this._map.get(n).push({cb:t,ctx:e}):this._map.set(n,[{cb:t,ctx:e}])},c.unlisten=function(n,t,e){if(this._map.has(n)){var o=this._map.get(n),c=o.findIndex((function(n){return n.cb===t&&n.ctx===e}));-1!==c&&o.splice(c,1)}},e(o,[{key:"isConnected",get:function(){return this._ws&&this._ws.readyState===WebSocket.OPEN}}],[{key:"Instance",get:function(){return n.GetInstance.call(this)}}]),o}(c));o._RF.pop()}}}));

System.register("chunks:///_virtual/ObjectPoolManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts","./DataManager.ts"],(function(t){var e,o,n,a,c,r,s;return{setters:[function(t){e=t.inheritsLoose,o=t.createClass},function(t){n=t.cclegacy,a=t.Node,c=t.instantiate},function(t){r=t.default},function(t){s=t.default}],execute:function(){n._RF.push({},"87108/KhZZHfIpKvDHRjJ9X","ObjectPoolManager",void 0);t("ObjectPoolManager",function(t){function n(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this)._objectPool=void 0,e._pool=new Map,e}e(n,t);var r=n.prototype;return r.get=function(t){(this._objectPool||(this._objectPool=new a("ObjectPool"),this._objectPool.setParent(s.Instance.stage)),this._pool.has(t))||(this._pool.set(t,[]),new a(t+"Pool").setParent(this._objectPool));var e=this._pool.get(t);if(0===e.length){var o=s.Instance.prefabMap.get(t),n=c(o);return n.name=t,n.setParent(this._objectPool.getChildByName(t+"Pool")),n.active=!0,n}var r=e.pop();return r.active=!0,r},r.ret=function(t){t.active=!1,this._pool.get(t.name).push(t)},o(n,null,[{key:"Instance",get:function(){return t.GetInstance.call(this)}}]),n}(r));n._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataManager.ts"],(function(e){var t,a,n,r,i,o,l,s,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,l=e.Label,s=e.Component},function(e){c=e.default}],execute:function(){var u,p,d,f,g,y,b;i._RF.push({},"a994f+yAZxLu4s05FW6CugX","PlayerManager",void 0);var m=o.ccclass,h=o.property;e("PlayerManager",(u=m("PlayerManager"),p=h(l),d=h(l),u((y=t((g=function(e){function t(){for(var t,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i))||this,n(t,"nameLabel",y,r(t)),n(t,"stateLabel",b,r(t)),t.id=void 0,t}return a(t,e),t.prototype.init=function(e){this.id=e.id,this.nameLabel.string=e.nickname;var t="";t=null!==c.Instance.roomInfo?e.id===c.Instance.roomInfo.ownerId?"房主":"":c.Instance.isMe(e.id)?"我":e.roomId?"房间 "+e.roomId.toString().padStart(2,"0"):"空闲",this.stateLabel.string=t,this.node.active=!0},t}(s)).prototype,"nameLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=t(g.prototype,"stateLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=g))||f));i._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Singleton.ts"],(function(n){var e,t,r,o,u;return{setters:[function(n){e=n.inheritsLoose,t=n.createClass},function(n){r=n.cclegacy,o=n.resources},function(n){u=n.default}],execute:function(){r._RF.push({},"62787J9NkFG0a5DUreClALR","ResourceManager",void 0);n("ResourceManager",function(n){function r(){return n.apply(this,arguments)||this}e(r,n);var u=r.prototype;return u.loadRes=function(n,e){return new Promise((function(t,r){o.load(n,e,(function(n,e){n?r(n):t(e)}))}))},u.loadDir=function(n,e){return new Promise((function(t,r){o.loadDir(n,e,(function(n,e){n?r(n):t(e)}))}))},t(r,null,[{key:"Instance",get:function(){return n.GetInstance.call(this)}}]),r}(u));r._RF.pop()}}}));

System.register("chunks:///_virtual/RoomManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.ts","./index3.ts","./DataManager.ts","./NetworkManager.ts","./PlayerManager.ts","./Enum.ts"],(function(e){var n,t,r,a,o,i,s,c,l,u,p,f,m,h,y,g,d,I,b,v,M,_;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,r=e.initializerDefineProperty,a=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose,i=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,l=e._decorator,u=e.Label,p=e.Node,f=e.Prefab,m=e.Button,h=e.UIOpacity,y=e.instantiate,g=e.director,d=e.Component},null,function(e){I=e.SceneEnum},function(e){b=e.default},function(e){v=e.NetworkManager},function(e){M=e.PlayerManager},function(e){_=e.ApiMsgEnum}],execute:function(){var R,S,w,C,L,P,x,z,B,G,k;c._RF.push({},"1fcb79zx7JGx7Tw/RaUzFcE","RoomManager",void 0);var A=l.ccclass,E=l.property;e("RoomManager",(R=A("RoomManager"),S=E(u),w=E(p),C=E(p),L=E(f),R((z=n((x=function(e){function n(){for(var n,t=arguments.length,o=new Array(t),i=0;i<t;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,r(n,"roomNameLabel",z,a(n)),r(n,"startButton",B,a(n)),r(n,"playerContainer",G,a(n)),r(n,"playerPrefab",k,a(n)),n}t(n,e);var c=n.prototype;return c.start=function(){v.Instance.listen(_.MsgRoom,this._onRoomSync,this),v.Instance.listen(_.MsgGameStart,this._onGameStart,this),this._render()},c.onDestroy=function(){v.Instance.unlisten(_.MsgRoom,this._onRoomSync,this),v.Instance.unlisten(_.MsgGameStart,this._onGameStart,this)},c._onRoomSync=function(e){b.Instance.roomInfo=e.room,this._render()},c._render=function(){this.roomNameLabel.string=b.Instance.roomInfo.name,this.startButton.active=b.Instance.isMe(b.Instance.roomInfo.ownerId);var e=b.Instance.roomInfo.players.length>=2;this.startButton.getComponent(m).interactable=e,this.startButton.getComponent(h).opacity=e?255:100,this._renderPlayerList(b.Instance.roomInfo.players)},c._renderPlayerList=function(e){for(var n,t=o(this.playerContainer.children);!(n=t()).done;){n.value.active=!1}for(;this.playerContainer.children.length<e.length;){var r=y(this.playerPrefab);r.active=!1,r.setParent(this.playerContainer)}for(var a=0;a<e.length;a++)this.playerContainer.children[a].getComponent(M).init(e[a])},c.handleClickLeave=function(){var e=i(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.Instance.callApi(_.ApiRoomLeave,{});case 2:n=e.sent,t=n.success,r=n.error,t?(b.Instance.roomInfo=null,g.loadScene(I.Hall)):console.error("Error joining room:",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c.handleClickStart=function(){var e=i(s().mark((function e(){var n,t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.Instance.callApi(_.ApiGameStart,{});case 2:n=e.sent,t=n.success,r=n.error,t||console.error("Error starting game:",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c._onGameStart=function(e){b.Instance.state=e.state,g.loadScene(I.Battle)},n}(d)).prototype,"roomNameLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=n(x.prototype,"startButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=n(x.prototype,"playerContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=n(x.prototype,"playerPrefab",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=x))||P));c._RF.pop()}}}));

System.register("chunks:///_virtual/RoomManager2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index.ts","./index3.ts","./DataManager.ts","./NetworkManager.ts","./Enum.ts"],(function(n){var e,t,r,o,i,a,l,s,c,u,p,m,f,g,b,h,d;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,r=n.initializerDefineProperty,o=n.assertThisInitialized,i=n.asyncToGenerator,a=n.regeneratorRuntime},function(n){l=n.cclegacy,s=n._decorator,c=n.Label,u=n.Button,p=n.Color,m=n.Component,f=n.director},null,function(n){g=n.SceneEnum},function(n){b=n.default},function(n){h=n.NetworkManager},function(n){d=n.ApiMsgEnum}],execute:function(){var y,v,w,L,j,B,M,R,x;l._RF.push({},"5c9b3fiwWNOwJ3nknq8LJ+u","RoomManager",void 0);var k=s.ccclass,z=s.property;n("RoomManager",(y=k("RoomManager"),v=z(c),w=z(u),L=z(c),y((M=e((B=function(n){function e(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return e=n.call.apply(n,[this].concat(i))||this,r(e,"nameLabel",M,o(e)),r(e,"joinButton",R,o(e)),r(e,"joinButtonLabel",x,o(e)),e.id=void 0,e}t(e,n);var l=e.prototype;return l.init=function(n){this.id=n.id,this.nameLabel.string=n.name+"  ( "+n.players.length+" / "+n.maxPlayers+" )";var e=n.players.length>=n.maxPlayers;this.joinButton.interactable=!e,this.joinButtonLabel.string=e?"人数已满":"加入房间",this.joinButtonLabel.color=e?new p(128,128,128):new p(255,255,255),this.node.active=!0},l.handleClickJoin=function(){var n=i(a().mark((function n(){var e,t,r,o;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.Instance.callApi(d.ApiRoomJoin,{roomId:this.id});case 2:e=n.sent,t=e.success,r=e.res,o=e.error,t?(b.Instance.roomInfo=r.room,f.loadScene(g.Room)):console.error("Error joining room:",o);case 7:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),e}(m)).prototype,"nameLabel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=e(B.prototype,"joinButton",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=e(B.prototype,"joinButtonLabel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=B))||j));l._RF.pop()}}}));

System.register("chunks:///_virtual/ShootManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index3.ts","./EventManager.ts"],(function(t){var o,n,e,i,s,h,u,c,a,r,d,_;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.Vec2,s=t.input,h=t.Input,u=t.UITransform,c=t.Sprite,a=t.Color,r=t.Component},function(t){d=t.EventEnum},function(t){_=t.default}],execute:function(){var l;n._RF.push({},"637eazumVNLUJd6beAw8GvD","ShootManager",void 0);var p=e.ccclass;e.property,t("ShootManager",p("ShootManager")(l=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this)._body=void 0,o._defaultPos=void 0,o._touchId=null,o}o(n,t);var e=n.prototype;return e.onLoad=function(){this._body=this.node.getChildByName("Body"),this._body.active=!1,this._defaultPos=new i(this._body.position.x,this._body.position.y),s.on(h.EventType.TOUCH_START,this._onTouchStart,this),s.on(h.EventType.TOUCH_END,this._onTouchEnd,this)},e.onDestroy=function(){s.off(h.EventType.TOUCH_START,this._onTouchStart,this),s.off(h.EventType.TOUCH_END,this._onTouchEnd,this)},e._onTouchStart=function(t){if(null===this._touchId){var o=t.getUILocation();o.x<this.node.parent.getComponent(u).width/2||(this._touchId=t.getID(),this._body.setPosition(o.x,o.y),this._body.getComponent(c).color=new a(255,255,255,150),this._emitWeaponShoot(),this.schedule(this._emitWeaponShoot,.2))}},e._onTouchEnd=function(t){null!==this._touchId&&t.getID()===this._touchId&&(this._touchId=null,this._body.setPosition(this._defaultPos.x,this._defaultPos.y),this._body.getComponent(c).color=new a(255,255,255,100),this.unschedule(this._emitWeaponShoot))},e._emitWeaponShoot=function(){_.Instance.emit(d.WeaponShoot)},n}(r))||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/Singleton.ts",["cc"],(function(n){var t;return{setters:[function(n){t=n.cclegacy}],execute:function(){t._RF.push({},"0ee5bhKiXFBD6OdLPlll91F","Singleton",void 0),n("default",function(){function n(){}return n.GetInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},n}())._instance=null,t._RF.pop()}}}));

System.register("chunks:///_virtual/State.ts",["cc","./DataManager.ts","./index2.ts"],(function(t){var i,n,a,e,o,r;return{setters:[function(t){i=t.cclegacy,n=t.AnimationClip,a=t.animation,e=t.Sprite},function(t){o=t.default},function(t){r=t.sortSpriteFrame}],execute:function(){i._RF.push({},"226c1khFFlHZILmsaEcWnPC","State",void 0);var s=t("ANIMATION_SPEED",.1);t("default",function(){function t(t,i,p,m){void 0===p&&(p=n.WrapMode.Normal),void 0===m&&(m=!1),this.animationClip=void 0,this.fsm=t,this.path=i,this.wrapMode=p,this.force=m;var h=new a.ObjectTrack;h.path=(new a.TrackPath).toComponent(e).toProperty("spriteFrame");var c=o.Instance.textureMap.get(this.path),u=r(c).map((function(t,i){return[i*s,t]}));h.channel.curve.assignSorted(u),this.animationClip=new n,this.animationClip.name=this.path,this.animationClip.duration=u.length*s,this.animationClip.addTrack(h),this.animationClip.wrapMode=this.wrapMode}return t.prototype.run=function(){var t;((null==(t=this.fsm.animationComponent.defaultClip)?void 0:t.name)!==this.animationClip.name||this.force)&&(this.fsm.animationComponent.defaultClip=this.animationClip,this.fsm.animationComponent.play())},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/State2.ts",["cc"],(function(){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"3e615nYhndL/IGt3FkS+kse","State",void 0),t._RF.pop()}}}));

System.register("chunks:///_virtual/StateMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./index3.ts"],(function(t){var e,r,a,n,i,s,u;return{setters:[function(t){e=t.inheritsLoose,r=t.createForOfIteratorHelperLoose,a=t.createClass},function(t){n=t.cclegacy,i=t._decorator,s=t.Component},function(t){u=t.FsmParamTypeEnum}],execute:function(){var o;n._RF.push({},"665381FD89O0o5HoKaI3a88","StateMachine",void 0);var c=i.ccclass;t("getInitParamsTrigger",(function(){return{type:u.Trigger,value:!1}})),t("getInitParamsNumber",(function(){return{type:u.Number,value:0}})),t("default",c("StateMachine")(o=function(t){function n(){for(var e,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))||this)._currentState=null,e.params=new Map,e.stateMachines=new Map,e.animationComponent=void 0,e.type=void 0,e}e(n,t);var i=n.prototype;return i.getParams=function(t){if(this.params.has(t))return this.params.get(t).value},i.setParams=function(t,e){this.params.has(t)&&(this.params.get(t).value=e,this.run(),this.resetTrigger())},i.resetTrigger=function(){for(var t,e=r(this.params);!(t=e()).done;){var a=t.value[1];a.type===u.Trigger&&(a.value=!1)}},a(n,[{key:"currentState",get:function(){return this._currentState},set:function(t){t&&(this._currentState=t,this._currentState.run())}}]),n}(s))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/StateMachineTemplate.ts",["cc"],(function(){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"ff33aeZaQhNHZAr82rsENTe","StateMachineTemplate",void 0),e._RF.pop()}}}));

System.register("chunks:///_virtual/SubStateMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,n;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"7f9faxxmCBBsotNLcQYVBTv","SubStateMachine",void 0);t("default",function(){function t(t){this._currentState=null,this.stateMachines=new Map,this.fsm=t}return e(t,[{key:"currentState",get:function(){return this._currentState},set:function(t){t&&(this._currentState=t,this._currentState.run())}}]),t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EntityManager.ts","./index.ts","./index3.ts","./DataManager.ts","./EventManager.ts","./WeaponStateMachine.ts","./Enum.ts"],(function(t){var n,o,e,i,a,s,r,c,h,p,u;return{setters:[function(t){n=t.inheritsLoose},function(t){o=t.cclegacy,e=t._decorator,i=t.UITransform},function(t){a=t.EntityManager},null,function(t){s=t.EntityStateEnum,r=t.EventEnum},function(t){c=t.default},function(t){h=t.default},function(t){p=t.WeaponStateMachine},function(t){u=t.InputTypeEnum}],execute:function(){var d;o._RF.push({},"eef308L3bZCL7y/KqU4Ozm0","WeaponManager",void 0);var y=e.ccclass;e.property,t("WeaponManager",y("WeaponManager")(d=function(t){function o(){for(var n,o=arguments.length,e=new Array(o),i=0;i<o;i++)e[i]=arguments[i];return(n=t.call.apply(t,[this].concat(e))||this)._body=void 0,n._anchor=void 0,n._point=void 0,n._owner=void 0,n}n(o,t);var e=o.prototype;return e.init=function(t){this._body=this.node.getChildByName("Body"),this._anchor=this._body.getChildByName("Anchor"),this._point=this._anchor.getChildByName("Point"),this._owner=t.id,this.fsm=this._body.addComponent(p),this.fsm.init(t.weaponType),this.state=s.Idle,h.Instance.on(r.WeaponShoot,this._onWeaponShoot,this)},e.onDestroy=function(){h.Instance.off(r.WeaponShoot,this._onWeaponShoot,this)},e._onWeaponShoot=function(){if(c.Instance.isMe(this._owner)){var t=this._point.getWorldPosition(),n=c.Instance.stage.getComponent(i).convertToNodeSpaceAR(t),o=this._anchor.getWorldPosition(),e=t.subtract(o).normalize();h.Instance.emit(r.ClientSync,{type:u.WeaponShoot,owner:this._owner,position:{x:n.x,y:n.y},direction:{x:e.x,y:e.y}}),this.state=s.Attack}},o}(a))||d);o._RF.pop()}}}));

System.register("chunks:///_virtual/WeaponStateMachine.ts",["./rollupPluginModLoBabelHelpers.js","cc","./State.ts","./StateMachine.ts","./index3.ts","./WeaponManager.ts"],(function(t){var e,n,a,i,s,c,o,r,h,u,p;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,a=t._decorator,i=t.Animation,s=t.AnimationClip},function(t){c=t.default},function(t){o=t.getInitParamsTrigger,r=t.default},function(t){h=t.ParamsNameEnum,u=t.EntityStateEnum},function(t){p=t.WeaponManager}],execute:function(){var l;n._RF.push({},"0beebIr+/BEkrqXHBNozK/R","WeaponStateMachine",void 0);var m=a.ccclass;t("WeaponStateMachine",m("WeaponStateMachine")(l=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var a=n.prototype;return a.init=function(t){this.type=t,this.animationComponent=this.node.addComponent(i),this.initParams(),this.initStateMachines(),this.initAnimationEvent()},a.initParams=function(){this.params.set(h.Idle,o()),this.params.set(h.Attack,o())},a.initStateMachines=function(){this.stateMachines.set(h.Idle,new c(this,""+this.type+u.Idle,s.WrapMode.Loop)),this.stateMachines.set(h.Attack,new c(this,""+this.type+u.Attack,s.WrapMode.Normal,!0))},a.initAnimationEvent=function(){var t=this;this.animationComponent.on(i.EventType.FINISHED,(function(){t.currentState===t.stateMachines.get(h.Attack)&&(t.node.parent.getComponent(p).state=u.Idle)}))},a.run=function(){switch(this.currentState){case this.stateMachines.get(h.Idle):case this.stateMachines.get(h.Attack):this.params.get(h.Attack).value?this.currentState=this.stateMachines.get(h.Attack):this.params.get(h.Idle).value?this.currentState=this.stateMachines.get(h.Idle):this.currentState=this.currentState;break;default:this.currentState=this.stateMachines.get(h.Idle)}},n}(r))||l);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});